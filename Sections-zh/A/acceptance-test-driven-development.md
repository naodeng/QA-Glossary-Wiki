# 验收测试驱动开发 (Acceptance Test Driven Development)

[验收测试驱动开发](#acceptance-test-driven-development)

### 相关术语：
- [测试驱动开发](/glossary/test-driven-development)
- [用户验收测试](/glossary/user-acceptance-testing)

### 参见：
- 维基百科
[维基百科](https://zh.wikipedia.org/wiki/验收测试驱动开发)

## 关于验收测试驱动开发的问题？

#### 基础知识与重要性

- **什么是验收测试驱动开发 (ATDD)？**

**验收测试驱动开发 (ATDD)** 是一种开发方法论。在这个方法论中，拥有不同视角的团队成员（开发人员、测试人员和业务客户）在编码开始前协作编写验收测试。其主要目标是为系统功能指定详细的、以客户为中心的标准，这些标准通过指导开发并提供对期望结果的清晰理解来发挥作用。

在 ATDD 中，验收测试以示例或场景的形式表达，通常使用 "Given-When-Then" 格式，从用户的角度描述系统行为。这些测试是自动化的，并充当动态文档和回归套件。

ATDD 促进了团队成员之间更好的沟通和理解，确保功能满足业务需求。它将开发工作与客户需求对齐，并有助于防止功能蔓延和缺陷。通过从一开始就关注客户需求，团队可以交付更有价值和更高质量的软件。

测试人员在 ATDD 中的角色超出了传统测试，包括参与需求澄清，并确保验收标准是可测试且清晰的。测试人员与开发人员和业务代表紧密协作，创建并自动化验收测试。

ATDD 常用的工具包括 **[Cucumber](/wiki/cucumber)**、**[SpecFlow](/wiki/specflow)** 和 **[FitNesse](/wiki/fitnesse)**，这些工具支持行为驱动开发 (BDD) 和实例化需求 (Specification by Example) 实践。这些工具允许用所有利益相关者都能理解的语言编写测试，弥补了技术人员和非技术人员之间的沟通鸿沟。

有效地实施 ATDD 需要思维方式和实践的转变，强调前期规格说明、持续反馈和迭代开发。它是敏捷和精益开发方法论中的一项关键实践，有助于交付满足用户期望的高质量软件。

- **为什么 ATDD 在软件开发中很重要？**

ATDD 在软件开发中至关重要，因为它确保所有利益相关者在编码开始前对需求有共同的理解。这种方法使开发人员、测试人员和业务代表围绕商定的验收标准达成一致，促进了更好的沟通和协作。通过从一开始就关注客户需求，ATDD 最大限度地降低了误解风险，并减少了开发周期后期代价高昂的返工可能性。

在开发过程早期整合 ATDD 有助于在问题升级前识别并解决它们，从而实现更高效且流向更顺畅的工作流。它鼓励使用简单的语言进行行为规格说明，使测试对所有相关方都易于理解。这种清晰度有助于预防缺陷，而不是在开发后才检测缺陷，这与传统测试方法相比是一种更主动的方法。

ATDD 还促进了持续反馈，允许在整个开发生命周期中进行迭代改进。这种迭代过程有助于优化产品，以更好地满足用户期望，最终产生与业务目标密切契合的高质量软件。

此外，ATDD 对自动化的强调支持了**[回归测试](/wiki/regression-testing)**，并实现了一个能够处理变化而无需显著增加工作量的可持续测试过程。这种**[自动化测试](/wiki/automated-testing)**框架对于在快速发展的环境中保持高水平质量至关重要，特别是在扩展到大型项目时。

总之，ATDD 的重要性在于它促进了共同理解，减少了返工，确保了与业务目标的一致，并支持一个可持续、高质量的开发过程。

- **ATDD 与传统测试方法有何不同？**

**ATDD** 与传统测试方法的不同之处主要在于其**协作方式**和**时机**。传统测试通常发生在开发阶段之后，测试人员根据已实现的功能创建并执行测试。相比之下，ATDD 涉及包括开发人员、测试人员和业务代表在内的多个利益相关者，他们在编写任何代码**之前**定义验收标准并创建验收测试。

ATDD 中的这种前期协作确保了所有各方对需求和“完成”的定义有共同的理解。它将重点从开发后寻找**[缺陷](/wiki/bug)**转移到通过尽早澄清期望来预防缺陷。此外，ATDD 鼓励**行为驱动开发 (BDD)**，即使用所有利益相关者都能理解的语言（通常采用 Given-When-Then 格式）编写测试。

虽然传统测试方法可能严重依赖**[手工测试](/wiki/manual-testing)**或事后创建自动化测试，但 ATDD 从一开始就集成了**[测试自动化](/wiki/test-automation)**。验收测试是自动化的，并成为回归套件的一部分，就新更改是否满足商定的标准提供即时反馈。

总之，ATDD 的前瞻性、协作性方法与传统的反应式测试方法形成鲜明对比，强调预防胜于检测，并培养了全团队对质量的共同责任感。

- **使用 ATDD 有哪些主要好处？**

ATDD 提供了几个增强软件开发过程的主要好处：
- **增强协作**：通过在开发周期早期引入各方利益相关者，ATDD 促进了更好的理解和沟通。
- **清晰的需求**：验收测试充当具体的辅助需求，减少了模糊性并确保软件满足业务需求。
- **早期缺陷检测**：通过前期定义验收标准，可以更早识别问题，降低后期修复缺陷的成本和精力。
- **客户满意度**：专注于满足验收标准可确保最终产品符合客户期望。
- **回归安全**：自动化验收测试提供了一个安全网，使重构和改进代码更安全且不破坏现有功能。
- **持续反馈**：定期执行验收测试可提供对产品状态的实时洞察，允许及时调整。
- **精简开发**：清晰的验收标准指导开发工作，防止功能蔓延和过度工程。

实施 ATDD 可以带来更高效、更协作且以质量为中心的开发生命周期，最终交付出更好地满足用户需求且经得起时间考验的软件。

- **ATDD 如何提高软件产品的质量？**

ATDD 通过确保精确满足**功能需求**且产品行为符合利益相关者预期，来提高**[软件质量](/wiki/software-quality)**。通过从一开始就关注客户需求，ATDD 促进了**清晰且可执行的规格说明**的创建。这些规格说明指导开发和测试，减少了由于误解或不完整需求导致的缺陷。

验收测试在代码编写**之前**定义，这意味着开发人员有一个清晰的目标。这种**测试先行 (Test-first)** 的方法有助于防止功能蔓延，并确保代码库仅包含通过测试所必需的内容，从而实现更简洁且更易维护的代码库。

此外，ATDD 鼓励开发人员、测试人员和业务利益相关者之间的协作。这种**跨功能沟通**有助于在开发过程早期识别并消除歧义，这能显著提高产品质量。

来自执行验收测试的**持续反馈**允许**早期识别问题**，相比在开发周期后期发现**[缺陷](/wiki/bug)**，修复成本通常更低。此外，验收测试套件成为了**动态文档**，可用于**[回归测试](/wiki/regression-testing)**，确保新更改不会破坏现有功能。

总之，ATDD 通过澄清需求、促进协作并提供持续反馈来贡献于软件质量，所有这些都有助于构建一个紧密契合业务需求和用户期望的产品。

#### 流程与技术

- **ATDD 涉及哪些关键步骤？**

ATDD 涉及的关键步骤包括：
1. **协作**：开发人员、测试人员和业务利益相关者共同定义验收标准。
2. **创建验收测试**：根据商定的标准，在开发开始前创建测试。
3. **开发**：在验收测试的指导下开发功能或用户故事。
4. **持续集成**：确保代码更改针对验收测试进行自动测试。
5. **精炼**：根据需要精炼验收测试，以应对需求或理解的变化。
6. **[测试执行](/wiki/test-execution)**：验证软件是否满足商定的验收标准。
7. **评审与反馈**：利益相关者确认验收测试涵盖了期望的功能和行为。
8. **[迭代](/wiki/iteration)**：根据需要重复这些步骤，直到功能满足验收标准。

验收测试通常是自动化的。它们用所有相关方都能理解的语言编写，通常使用 **[BDD](/wiki/bdd)** 框架。这确保了测试既作为规格说明又作为验证手段。

```gherkin
功能：用户登录
  场景：成功登录
    假设 我在登录页面
    当 我输入有效的凭据
    那么 我应该被重定向到仪表板
```

有效的 ATDD 需要强大的协作文化、清晰的沟通以及全员对质量的承诺。

- **在 ATDD 中如何创建验收测试？**

ATDD 中的验收测试是通过**协作**创建的。过程始于定义**用户故事**，从用户视角描述期望的功能。每个用户故事包含**验收标准**，作为验收测试的基础。

团队讨论验收标准以确保对需求达成共识。这种讨论通常涉及**实例化需求 (Specification by Example)** 或 **示例映射 (Example Mapping)**。

一旦标准达成一致，就会编写**可执行的规格说明**。这些通常结构化为 **Given-When-Then** 语句，可以直接转换为自动化测试。

例如：
```gherkin
假设 用户已登录
当 他们尝试下订单时
那么 订单应该被处理
```

这些规格说明随后使用 **[Cucumber](/wiki/cucumber)** 或 **[SpecFlow](/wiki/specflow)** 等框架进行自动化。

```java
@Given("^the user is logged in$")
public void the_user_is_logged_in() {
    // 确保用户已登录的代码
}

@When("^they attempt to place an order$")
public void they_attempt_to_place_an_order() {
    // 模拟下单的代码
}

@Then("^the order should be processed$")
public void the_order_should_be_processed() {
    // 验证订单处理的断言
}
```

- **ATDD 中常用哪些技术？**

在 ATDD 中，采用几种技术来确保满足验收标准且软件行为符合预期：
- **行为驱动开发 (BDD)**：使用自然语言风格描述应用行为，常使用 Cucumber 或 SpecFlow。
- **实例化需求 (Specification by Example)**：协作定义阐明特定行为或需求的示例。
- **示例映射 (Example Mapping)**：一种协作技术，使用不同颜色卡片代表故事、规则、示例和问题。
- **可执行的规格说明**：编写可直接针对代码执行的验收测试，通常涉及领域特定语言 (DSL)。
- **测试先行开发**：在实际实现前编写验收测试。
- **协作工具**：使用 **[JIRA](/wiki/jira)** 等平台促进协作。
- **持续集成 (CI)**：自动运行验收测试以获取即时反馈。
- **测试制品版本控制**：将测试与代码库一起存储，保持同步。

这些技术有助于定义清晰的标准并确保软件满足业务需求。

- **ATDD 如何集成到软件开发生命周期中？**

ATDD 通过从一开始就使开发活动与验收标准对齐，集成到软件开发生命周期 (SDLC) 中。
- **初始阶段**：利益相关者协作定义并理解需求。
- **计划与设计**：验收测试被评审和精炼，确保其清晰且可测试。
- **开发开始**：验收测试指导编码，实行 **测试先行** 实践。
- **测试阶段**：自动化验收测试频繁执行，提供即时反馈。
- **发布前**：ATDD 确保产品符合业务需求。
- **部署后**：这些测试成为**回归套件**的一部分。

这种集成支持了一个可持续、以质量为中心的开发过程。

- **测试人员在 ATDD 中的角色是什么？**

在 ATDD 中，测试人员的角色是多方面的，专注于**协作**、**规格说明**和**验证**。
- 他们与开发人员和利益相关者密切合作，澄清需求。
- 他们贡献于**用户故事**和验收测试的创建。
- 他们参与**持续精炼**，通常在配对编程中创建/维护**[测试自动化](/wiki/test-automation)**。
- 他们负责维护**[测试套件](/wiki/test-suite)**的可靠性和效率。
- 他们可能负责**[测试数据](/wiki/test-data)**管理和**[测试环境](/wiki/test-environment)**搭建。
- 他们协助促进 **三个火枪手 (Three Amigos)** 会议。

最终，ATDD 中的测试人员确保交付的产品不仅满足技术要求，而且实现业务价值并满足用户需求。

#### 工具与技术

- **ATDD 常用哪些工具？**

常用工具包括：
- **[Cucumber](/wiki/cucumber)**：利用 Gherkin 语言，支持跨方协作。
- **[SpecFlow](/wiki/specflow)**：类似于 Cucumber，专为 .NET 框架定制。
- **[FitNesse](/wiki/fitnesse)**：将 Wiki 文档与自动化测试框架结合。
- **Robot Framework**：高度可扩展的关键字驱动框架。
- **Concordion**：与 JUnit 集成，允许在 HTML 中编写规格。
- **JBehave**：Java 中的 **[BDD](/wiki/bdd)** 框架。
- **SerenityBDD**：增强其他 BDD 工具，提供高级报告。

这些工具支持以所有利益相关者都能理解的语言定义验收标准，并促进**[测试自动化](/wiki/test-automation)**。

- **这些工具如何支持 ATDD 过程？**

测试自动化工具通过允许执行行为驱动格式的测试来促进 ATDD 过程。它们支持：
- **自动验证**：确保软件符合规格。
- **持续反馈**：集成到 CI 中，向开发人员提供即时反馈。
- **支持重构**：维护一组可随时运行的验证套件。
- **报告功能**：使测试状态对所有利益相关者透明。

例如，典型的工具链会执行 Gherkin 场景场景并对照应用验证其描述的行为。

- **使用这些工具需要哪些技能？**

要有效地使用这些工具，需要以下技能：
- **编程知识**：熟练掌握 Java、Python 或 C#。
- **了解软件开发**：熟悉开发生命周期。
- **测试框架专长**：熟悉 JUnit、TestNG 或 pytest。
- **版本控制**：能够使用 Git 管理**[测试脚本](/wiki/test-script)**。
- **CI/CD**：了解 Jenkins、CircleCI 或 Travis CI。
- **解决问题能力**：能够排查测试脚本中的问题。
- **沟通能力**：与利益相关者清晰沟通需求。

- **自动化在 ATDD 中的角色是什么？**

自动化在 ATDD 中起着关键作用，能够高效且一致地验证和回归验收标准。
- **促进持续测试**。
- **确保可重复性**。
- **增加[测试覆盖率](/wiki/test-coverage)**。
- **增强协作**。
- **缩短反馈循环**。
- **支持重构**。

自动化测试成为动态文档，通常使用领域特定语言 (DSL) 编写。

- **如何在敏捷开发环境中实施 ATDD？**

在敏捷环境中实施 ATDD 涉及：
1. **前期协作**：在开发前定义验收标准。
2. **计划会议**：讨论用户故事并使用 **[BDD](/wiki/bdd)** 工具编写测试。
3. **协作开发**：开发人员和测试人员协同工作，集成到 CI 流水线中。
4. **迭代与反馈**：定期与利益相关者评审结果，消除误解。
5. **重构**：维护整洁的代码和测试。
6. **跨功能团队**：确保成员具备开发和测试的能力。

#### 挑战与解决方案

- **ATDD 中遇到的一些常见挑战是什么？**

常见挑战包括：
- **协作困难**：各方沟通不畅。
- **编写不清晰的标准**：需要技能和经验来编写可测试的标准。
- **维护[测试套件](/wiki/test-suite)**：随着应用演变，套件维护可能很耗时。
- **[测试数据](/wiki/test-data)**管理：多环境下的数据管理。
- **平衡覆盖率与速度**。
- **[不稳定测试 (Flaky tests)](/wiki/flaky-test)**。
- **传统流程的集成阻力**。

- **如何克服这些挑战？**

可以通过以下战略方法克服：
- **建立协作文化**。
- **持续学习**。
- **增量改进**。
- **熟练掌握工具**。
- **实施反馈循环**。
- **定期重构测试**。
- **模块化设计**。
- **基于风险分配资源**。

- **实施 ATDD 的最佳实践有哪些？**

最佳实践包括：
- **前期协作**。
- **编写清晰简洁的测试**。
- **尽早并频繁地自动化**。
- **维护单一事实来源**。
- **定期重构**。
- **集成到 CI/CD 流水线**。
- **基于风险和业务价值确定优先级**。

- **如何针对大型项目扩展 ATDD？**

扩展 ATDD 需要：
- **结构化验收测试**以反映模块化架构。
- **利用版本控制**进行同步。
- **隔离测试环境**。
- **分布式测试执行**以处理增加的负载。
- **利用协作工具支持追溯性**。
- **模块化并重用测试组件**。

- **如何评估 ATDD 的有效性？**

通过以下指标评估其有效性：
- **缺陷率降低**：发布后缺陷数减少。
- **[测试覆盖率](/wiki/test-coverage)**提高。
- **交付周期 (Cycle time)** 缩短。
- **反馈循环持续时间**缩短。
- **团队协作水平**提升。
- **[测试套件](/wiki/test-suite)**执行时间优化。
- **验收测试初次运行通过率**。
- **客户满意度**。
